# -Ergasia2_E17052_Zegkinoglou_Sotiris

Επεξήγηση Dockerfile: Tο dockerfile μας φτιάχνει το image μας
  1# Θέλουμε φτιάχνουμε το Image με βάση το ubuntu
  2-3-4# Εγκαθηστούμε τα dependecies που χρειαζόμαστε όπως να κάνουμε τα packages που έχουμε update(RUN apt-get update) αλλά και την python3 , pymongo 
  5-6# Δημιουργούμε τα directories app και app/data
  7# Κάνουμε copy το αρχείο python(service.py) μέσα στο directory app
  8# Προσθέτουμε το data μέσα στο directory data
  9# Κάνουμε expose το port 5000 για να τρέξει το service μας.
  10# Oρίζουμε το working directory στο /app
  11# Αλλάζουμε το default entrypoint στο αρχείο python που έχουμε
  
  
Eκτέλεση προγράμματος:
  Για να εκτελέσουμε το πρόγραμμα μας , πρέπει αρχικά να έχουμε τα αρχεία τοπικά στον υπολογιστή μας , εγκατεστημένο το docker αλλά και το docker-compose
  Έπειτα


Επεξήγηση Endpoints:

1) Endpoint Διαχειριστή
Με το που ξεκινάει το πληροφοριακό σύστημα για πρώτη φορά δημιουργείται στο Collection Users μια εγγραφή με στοιχεία name:"admin" , password:"admin" , email:"admin" , category:   "admin" η οποία προφανώς αντιστοιχεί στον διαχειριστή του συστήματος. Ο διαχειριστής για να εισέλθει το σύστημα χρησιμοποιεί το endpoint login που θα αναλύσουμε στα endpoint     των απλών users. Μόλις ο διαχειριστής κάνει login δέχεται ένα uuid που αντιστοίχει σε αυτόν λόγω της category:"admin" που έχει. Για να μπορέσει να εκτελέσει τις παρακάτω διαδικασίες πρέπει να το πέρασει (uuid) μέσω του header και συγκεκριμένα της μεταβλητής Authorization.

  1.1 /createProduct:
   O διαχείριστης εισάγει ενα νέο προιόν στο collections Products με όνομα , τιμή , περιγραφή , απόθεμα , κατηγορία. Όλα τα πεδία είναι υποχρεωτικά προς συμπλήρωση. Αν εισάγει   κάποιο όνομα προιόντος που ήδη υπάρχει ενημέρωνεται απο το σύστημα με το αντίστοιχο response.

  1.2 /deleteProduct
  O διαχείριστης για να διαγράψει ενα προιον πρεπει να δώσει ως δεδομένο το id του προιόντος το οποίο αντιστοίζεται με το _id που δημιουργεί η mongodb μόλις εισάγεις μια νέα         εγγραφή στο collection. Αν δεν υπάρχει προιον με το συγκεκριμένο id τότε λαμβάνει το αντίστοιχο response.
  
  1.3 /updateProct
   O διαχείριστης για να αλλάξει ενα προιον πρεπει να δώσει ως δεδομένο το id του προιόντος το οποίο αντιστοίζεται με το _id που δημιουργεί η mongodb μόλις εισάγεις μια νέα       εγγραφή στο collection. Αν δεν υπάρχει προιον με το συγκεκριμένο id τότε λαμβάνει το αντίστοιχο response. Έπειτα μπορεί να δώσει όποιο δεδομένο θέλει να αλλάξει. Το σύστημα   ελένχει μέσω if statements αν υπάρχουν δεδόμενα απο τον χρήστη για name/price/description/category/stock και όποια έχουν κάποια τιμή τα αλλάζει.
  
  
2)Endpoint Χρήστη
Ανάλογα το category του user καλείται και η αντίστοιχη συνάρτηση για την δημιουργία του uuid για user ή admin (user_session/admin_session)
 
  2.1 /createUser
  Ο χρήστης για να μπορέσει να χρησιμοποιήσει τις λειτουργίες του συστήματος πρέπει να κάνει εγγραφή στο σύστημα. Απαίραιτητα δεδομένα είναι το email , password και name. To  συστήμα απο μόνο του προσθέτει το category:user για να ξεχωρίζει τους απλούς users απο τους admins. Aν υπάρχει άλλως χρήστης με το ίδιο email σταματάει η εισαγωγή του στο collection users και επιστρέφεται το αντίστοιχο response.
  
  2.2 /login
  Άφου ο χρήστης έχει δημιουργήσει τον λογαριασμό του , για να εισέλθει σε αυτόν πρέπει να εισάγει το email και το password. Το σύστημα ελέγχει τα στοιχεία και αν τα επιβεβαίωσει στέλνει στον χρήστη το uuid του ώστε να μπορεί να χρησιμοποιεί τις υπολοίπες δυνατότητες του συστήματος. Αν δεν βρεθεί εγγραφή με το αντίστοιχο username και password ενημερώνεται ο χρήστης με το αντίστοιχο response.
  
  2.3 /searchProduct
  Για να χρησιμοποιήσει το συγκεκριμένο endpoint ο χρήστης πρέπει να περάσει το uuid που του δόθηκε στο login. (Το ίδιο ισχύει και για τα παρακάτω endpoints). Έπειτα για την αναζήτηση προιόντος χρειάζεται είτε η κατηγορία αυτού ή το id του ή το όνομα του. Το σύστημα πρώτα επαληθεύει το uuid του χρήστη , έπειτα ελεγχεί (if statements) αν έχει ορισθεί το category ή το id ή το name και κάνει το ανάλογο find. Αν βρεθεί το προίον το επιστρέφει μαζί με τις πληροφορίες του στον χρήστη , ενώ αν δεν βρεθεί στέλνει το αντίστοιχο response.
  
  2.4/addToCart
  Ο χρήστης έχει την δυνατότητα να προσθέσει ενα προίον στο καλάθι του ορίζοντας το id αυτού αλλά και την ποσότητα (ammount) που επιθυμεί. Το σύστημα ελέγχει αν το id ύπαρχει και έπειτα αν η ποσότητα που ζήτησε ο πελάτης δεν υπερβαίνει το stock. Aν και οι 2 συνθήκες επιβαιώθουν οι απαραίτητες τιμές περνάνε στο dictionary item το οποίο προστείθεται στην λίστα user_cart το οποίο εμφανίζεται στον χρήστη μαζί με την συνολική τιμή του εκεινή την στιγμή . Aν δέν υπάρχει το συγκεκριμένο id η το απαιτούμενο stock τότε επιστρέφεται το αντίστοιχο Response.
  
  2.5/showCart
  Με το συγκεκριμένο endpoint ο χρήστης μπορεί να δεί όλα τα αντικείμενα που έχει στο καλαθί του μαζί με την συνολική τιμή τους.
  
  2.6/deleteCartProduct
  Ο πελάτης μπορεί να εισάγει το id ενός προιοντος που έχει στο καλάθι του και να το διαγράψει. Το σύστημα ελέγχει αν αυτό το προιον είναι μέσα στο καλάθι του χρήστη και είτε το διαγράφει είτε ενημερώνει τον χρήστη με το αντίστοιχο Response.
  
  2.7/buyCart
  O πελάτης για να ολοκληρώση την αγορά του πρέπει να εισαγεί τον 16ψήφιο κωδικό της κάρτας του. Το σύστημα ελέγχει αν το καλάθι έχει έστω ένα προιόν μέσα και έπειτα αν ο κωδικός είναι 16 ψηφίων. Στην συνέχειεισάγει στο collection Users στο συγκεκρίμενο χρήστη (με βάση το uuid του) στο key OrderHistory τα προιόντα που έχει στο καλάθι του και έπειτα εκτύπωνει την αποδείξη με τα απαραίτητα δεδομένα.
  
  2.8/showHistory
  Μία ακόμα δυνατότητα του χρήστη είναι να μπορεί να δει τις προηγούμενες παραγγελείες του. Το σύστημα τον βρίσκει με βάση το uuid που περιέχει το email του και το εμφανίζεται το OrderHistory. Αν είναι κενό επιστρέφει το αντίστοιχο μήνυμα.
  
  2.9/deleteUser
  Τέλος ο χρήστης μπορεί να διαγράψει τον προσωπικό του λογαριασμό. Με βάση το uuid που περιέχει το email του , το σύστημα τον διαγράφει απο το collection users με αποτέλεσμα να μην έχει πλέον την δυνατότητα να χρησιμοποιήσει τα παραπάνω endpoints.
  
